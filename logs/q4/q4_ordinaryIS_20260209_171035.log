Q4 Off-policy Monte Carlo (Importance Sampling) Log
timestamp: 2026-02-09T17:10:35.114999
N=5, gamma=0.9, episodes=50000, max_steps=200
Goal state: s_{4,4}
Grey states: s_{0,4}, s_{2,2}, s_{3,0}
Reward-on-arrival: r = R(s_next)
Expected behavior: WIS stable (low variance), OIS can be unstable (high variance).

=== Value Iteration Baseline (VI) ===
iters=9, time_s=0.000359
V*:
 -0.43    0.63    1.81    3.12    4.58*
  0.63    1.81    3.12    4.58    6.20 
  1.81    3.12    4.58*   6.20    8.00 
  3.12*   4.58    6.20    8.00   10.00 
  4.58    6.20    8.00   10.00     G   

pi*:
 →   →   →   ↓   ↓ 
 →   →   →   →   ↓ 
 →   ↓   →   →   ↓ 
 →   →   →   →   ↓ 
 →   →   →   →   G 

============================================================

k=0  elapsed_s=0.000000 [OIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    0.00    0.00 
  0.00    0.00    0.00*   0.00    0.00 
  0.00*   0.00    0.00    0.00    0.00 
  0.00    0.00    0.00    0.00     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   G 

------------------------------------------------------------

k=0  elapsed_s=0.006242 [OIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    0.00    0.00 
  0.00    0.00    0.00*   0.00    0.00 
  0.00*   0.00    0.00    0.00    0.00 
  0.00    0.00  196.16  799.23     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   ↓   ←   G 

------------------------------------------------------------

k=1  elapsed_s=0.011586 [OIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    0.00    0.00 
  0.00    0.00    0.00*   0.00    0.00 
  0.00*   0.00    0.00    0.00    0.00 
  0.00    0.00  196.16  799.23     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   ↓   ←   G 

------------------------------------------------------------

k=2  elapsed_s=0.019682 [OIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    0.00    0.00 
  0.00    0.00    0.00*   0.00    0.00 
  0.00*   0.00    0.00    0.00    0.00 
  0.00    0.00  196.16  799.23     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   ↓   ←   G 

------------------------------------------------------------

k=3  elapsed_s=0.028262 [OIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    0.00    0.00 
  0.00    0.00    0.00*   0.00    0.00 
  0.00*   0.00    0.00    0.00    0.00 
  0.00    0.00  196.16  799.23     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   →   ↓ 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   ↓   ←   G 

------------------------------------------------------------

k=10  elapsed_s=0.036983 [OIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    0.00    0.00 
  0.00    0.00    0.00* 2575.65  146.06 
  0.00*   0.00   99.20   32.00   99.20 
  0.00    0.00  397.18  2575.65     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   →   ↓ 
 →   →   →   ↓   ↓ 
 →   →   →   →   ← 
 →   →   ↓   ↓   G 

------------------------------------------------------------

k=100  elapsed_s=0.052946 [OIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    0.00    0.00 
  0.00    0.00    0.00* 2575.65   97.04 
  0.00*   0.00   99.20   32.00   99.20 
  0.00    0.00  397.18  2575.65     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   →   ← 
 →   ↓   →   ↓   ↓ 
 →   →   →   →   ← 
 →   →   ↓   ↓   G 

------------------------------------------------------------

k=1000  elapsed_s=0.148569 [OIS]
V_k:
  0.00    0.00   -1.00   -1.00   -1.00*
  0.00    0.00   -1.00   -1.00    0.00 
  0.00    0.00    0.00* 1287.32   72.53 
 -1.00*  -1.00   99.20   23.75   99.20 
  0.00    0.00  397.18  1326.23     G   
Greedy policy (w.r.t. Q_k):
 ↑   →   →   ↓   ↓ 
 ←   ←   →   →   ← 
 ↓   ↓   ↓   ↓   ↓ 
 ↓   →   →   →   ← 
 →   ↓   ↓   ←   G 

------------------------------------------------------------

k=5000  elapsed_s=0.552574 [OIS]
V_k:
 -1.00   -1.00   -1.94   -1.00   -2.10*
 -1.73   -1.00   -1.00   -1.00   -1.00 
 -1.00   -1.44   -1.88* 428.44   25.51 
 -1.94*  -1.82   20.75    8.00   17.72 
 -2.10   -1.55  168.71  857.88     G   
Greedy policy (w.r.t. Q_k):
 ↓   ↓   ←   ↓   ← 
 →   ←   →   ←   → 
 ↑   ↑   →   ↓   ↓ 
 ↓   ↑   →   →   ← 
 ←   →   ↓   ↓   G 

------------------------------------------------------------

k=10000  elapsed_s=1.074775 [OIS]
V_k:
 -1.73   -1.86   -2.15   -1.00   -2.24*
 -1.39   -1.35   -1.41   -2.32   -1.78 
 -1.00   -1.88   -1.47* 150.18   16.04 
 -2.47*  -2.02   14.22    6.62   14.60 
 -1.39   -1.73   98.00  262.47     G   
Greedy policy (w.r.t. Q_k):
 ↑   ↓   →   ↓   ← 
 ↓   →   →   ←   → 
 ↑   ←   ↓   ↓   ↓ 
 ↑   ↑   →   →   ← 
 ←   →   ↓   ←   G 

------------------------------------------------------------

k=20000  elapsed_s=2.073407 [OIS]
V_k:
 -1.98   -2.10   -3.27   -2.18   -2.16*
 -1.68   -1.85   -1.60   71.60    1.30 
 -2.37   -2.20   56.81*  83.14   34.12 
 -2.15*   2.28   17.95   16.70   10.12 
 -1.99   -2.03   58.40  123.83     G   
Greedy policy (w.r.t. Q_k):
 ↑   ↓   →   ↓   ↓ 
 ←   →   →   ↓   ↓ 
 ←   ←   ↓   →   ↑ 
 ↑   →   ←   →   → 
 ←   ↑   ↓   ←   G 

------------------------------------------------------------

k=49999  elapsed_s=5.048252 [OIS]
V_k:
 -2.51   -3.44   -2.78   -3.88   -3.05*
 -3.66   16.77   -2.62   51.10   -2.54 
 -2.50   18.85   35.74*  48.59   10.30 
 -3.79*   0.94   13.97   17.15   10.58 
 -3.47   -3.12   21.08   59.30     G   
Greedy policy (w.r.t. Q_k):
 ←   ↑   →   ↓   ↓ 
 ↓   ↓   →   ↓   ↓ 
 ↑   ↑   ↓   ↓   ↓ 
 ↑   →   →   →   → 
 ←   →   ↓   ↓   G 

------------------------------------------------------------

