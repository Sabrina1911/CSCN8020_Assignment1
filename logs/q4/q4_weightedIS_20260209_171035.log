Q4 Off-policy Monte Carlo (Importance Sampling) Log
timestamp: 2026-02-09T17:10:35.121672
N=5, gamma=0.9, episodes=50000, max_steps=200
Goal state: s_{4,4}
Grey states: s_{0,4}, s_{2,2}, s_{3,0}
Reward-on-arrival: r = R(s_next)
Expected behavior: WIS stable (low variance), OIS can be unstable (high variance).

=== Value Iteration Baseline (VI) ===
iters=9, time_s=0.000359
V*:
 -0.43    0.63    1.81    3.12    4.58*
  0.63    1.81    3.12    4.58    6.20 
  1.81    3.12    4.58*   6.20    8.00 
  3.12*   4.58    6.20    8.00   10.00 
  4.58    6.20    8.00   10.00     G   

pi*:
 →   →   →   ↓   ↓ 
 →   →   →   →   ↓ 
 →   ↓   →   →   ↓ 
 →   →   →   →   ↓ 
 →   →   →   →   G 

============================================================

k=0  elapsed_s=0.000000 [WIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    0.00    0.00 
  0.00    0.00    0.00*   0.00    0.00 
  0.00*   0.00    0.00    0.00    0.00 
  0.00    0.00    0.00    0.00     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   G 

------------------------------------------------------------

k=0  elapsed_s=0.003840 [WIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    0.00    0.00 
  0.00    0.00    0.00*   0.00    0.00 
  0.00*   0.00    0.00    0.00    0.00 
  0.00    0.00    0.00   10.00     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   G 

------------------------------------------------------------

k=1  elapsed_s=0.014049 [WIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    0.00    0.00 
  0.00    0.00    0.00*   0.00    0.00 
  0.00*   0.00    0.00    0.00   10.00 
  0.00    0.00    0.00   10.00     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   ↓ 
 →   →   →   →   G 

------------------------------------------------------------

k=2  elapsed_s=0.027596 [WIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    0.00    0.00 
  0.00    0.00    0.00*   0.00    8.00 
  0.00*   0.00    0.00    0.00   10.00 
  0.00    0.00    0.00   10.00     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   →   → 
 →   →   →   →   ↓ 
 →   →   →   →   ↓ 
 →   →   →   →   G 

------------------------------------------------------------

k=3  elapsed_s=0.038418 [WIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    4.58    0.00 
  0.00    0.00    0.00*   6.20    8.00 
  0.00*   0.00    0.00    8.00   10.00 
  0.00    0.00    0.00   10.00     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   →   ↓   → 
 →   →   →   ↓   ↓ 
 →   →   →   →   ↓ 
 →   →   →   →   G 

------------------------------------------------------------

k=10  elapsed_s=0.050728 [WIS]
V_k:
  0.00    0.00    0.00    0.00    0.00*
  0.00    0.00    0.00    4.58    6.20 
  0.00    0.00    0.00*   6.20    8.00 
  0.00*   0.00    0.00    8.00   10.00 
  0.00    0.00    0.00   10.00     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   →   → 
 →   →   ↓   ↓   ↓ 
 →   →   →   ↓   ↓ 
 →   →   →   →   ↓ 
 →   →   →   →   G 

------------------------------------------------------------

k=100  elapsed_s=0.072291 [WIS]
V_k:
  0.00    0.63    0.00    0.00    4.20*
  0.63    1.81    3.11    4.58    5.98 
  0.00    0.00    4.58*   6.20    8.00 
  0.00*   4.58    6.20    8.00   10.00 
  4.58    6.20    7.85   10.00     G   
Greedy policy (w.r.t. Q_k):
 ←   ↓   →   →   ↓ 
 →   →   →   ↓   ↓ 
 →   ↓   →   ↓   ↓ 
 →   →   →   →   ↓ 
 →   →   →   →   G 

------------------------------------------------------------

k=1000  elapsed_s=0.179213 [WIS]
V_k:
  0.00    0.62    0.00    3.12    4.49*
  0.63    1.81    3.11    4.58    6.18 
  1.80    3.08    4.57*   6.19    8.00 
  3.12*   4.57    6.19    8.00   10.00 
  4.57    6.16    7.96   10.00     G   
Greedy policy (w.r.t. Q_k):
 ←   ↓   ←   ↓   ↓ 
 →   ↓   →   ↓   ↓ 
 →   ↓   ↓   →   ↓ 
 ↓   →   →   ↓   ↓ 
 →   →   →   →   G 

------------------------------------------------------------

k=5000  elapsed_s=0.620504 [WIS]
V_k:
 -0.43    0.63    1.81    3.12    4.54*
  0.63    1.80    3.11    4.57    6.18 
  1.79    3.10    4.57*   6.19    7.99 
  3.12*   4.58    6.19    7.99   10.00 
  4.57    6.19    7.98   10.00     G   
Greedy policy (w.r.t. Q_k):
 ↓   →   →   ↓   ↓ 
 →   →   →   ↓   ↓ 
 →   ↓   →   ↓   ↓ 
 →   →   ↓   →   ↓ 
 →   →   →   →   G 

------------------------------------------------------------

k=10000  elapsed_s=1.152291 [WIS]
V_k:
 -0.44    0.63    1.80    3.11    4.55*
  0.63    1.79    3.11    4.57    6.18 
  1.80    3.09    4.56*   6.19    7.99 
  3.12*   4.56    6.18    7.99   10.00 
  4.56    6.19    7.98   10.00     G   
Greedy policy (w.r.t. Q_k):
 →   →   →   ↓   ↓ 
 →   ↓   →   ↓   ↓ 
 →   ↓   →   ↓   ↓ 
 →   →   ↓   ↓   ↓ 
 →   →   →   →   G 

------------------------------------------------------------

k=20000  elapsed_s=3.900143 [WIS]
V_k:
 -0.44    0.61    1.80    3.11    4.56*
  0.62    1.80    3.11    4.57    6.18 
  1.80    3.10    4.57*   6.19    7.99 
  3.11*   4.56    6.18    7.99   10.00 
  4.55    6.18    7.98   10.00     G   
Greedy policy (w.r.t. Q_k):
 →   ↓   →   ↓   ↓ 
 ↓   →   →   ↓   ↓ 
 →   ↓   →   ↓   ↓ 
 →   →   →   →   ↓ 
 →   →   →   →   G 

------------------------------------------------------------

k=49999  elapsed_s=7.413415 [WIS]
V_k:
 -0.44    0.62    1.80    3.10    4.56*
  0.62    1.79    3.10    4.56    6.18 
  1.80    3.10    4.56*   6.18    7.99 
  3.11*   4.56    6.18    7.99   10.00 
  4.55    6.18    7.99   10.00     G   
Greedy policy (w.r.t. Q_k):
 →   ↓   →   ↓   ↓ 
 →   →   →   ↓   ↓ 
 →   ↓   →   ↓   ↓ 
 →   →   ↓   →   ↓ 
 →   →   →   →   G 

------------------------------------------------------------

=== Evidence (WIS vs VI) ===
max |V_WIS - V_VI| = 0.027647

